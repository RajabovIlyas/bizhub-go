(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{67322:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/panel/brands",function(){return c(37692)}])},37692:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return L}});var d=c(47568),e=c(14924),f=c(10797),g=c(34051),h=c.n(g),i=c(85893),j=c(9669),k=c.n(j),l=c(67294),m=c(82668),n=c(2072),o=c(57632),p=c(92456),q=c(7641),r=c(94184),s=c.n(r),t=c(14212),u=c(75758),v=function(a){var b=a.brand,c=a.reload,e=(0,l.useState)(!1),f=e[0],g=e[1],j=function(){g(function(a){return!a})},k=function(a){var b,e=(0,o.Z)();u.eventManager.emit("brands:edit",a,e),u.eventManager.once("brands:edit:response:".concat(e),(b=(0,d.Z)(h().mark(function a(b){return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b){a.next=3;break}return a.next=3,c();case 3:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)}))};return(0,i.jsxs)("div",{className:"shadow-main flex flex-col rounded-[10px] bg-white pt-[15px] px-[15px] pb-[0px]",children:[(0,i.jsxs)("div",{className:"flex cursor-pointer select-none items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-[9px]",children:[(0,i.jsx)("img",{alt:"Category",className:"h-[20px] rounded-[5px] border overflow-hidden w-[20px]",src:"/cdn/".concat(b.logo)}),(0,i.jsx)("button",{type:"button",onClick:function(){k(b._id)},className:"py-[1px] px-[6px] hover:bg-gray-50 rounded-main/2",children:(0,i.jsx)("h2",{className:"font-[600] text-[16px]",children:b.name})})]}),(0,i.jsx)("button",{onClick:j,className:"outline-none flex-grow flex justify-end",children:(0,i.jsx)(t.Z,{name:"chevronUp",className:s()(!f&&"rotate-[180deg] transform","stroke-[#6E5AD1] fill-transparent transition-all")})})]}),(0,i.jsxs)("div",{className:s()(f?"h-auto opacity-[1] pt-[20px] visible":"h-0 opacity-0 invisible","flex flex-wrap transition-all duration-[100ms] mt-[15px] border-t"),children:[0==b.sub_brands.length&&(0,i.jsx)("h1",{className:"pb-[20px] text-center w-full transition-all duration-[100ms] text-gray-400 italic",children:"Not found sub category"}),b.sub_brands.map(function(a,b){return(0,i.jsx)("button",{type:"button",onClick:function(){k(a._id)},className:s()(f?"visible opacity-[1]":"invisible opacity-0","font-[400] hover:text-primary transition-all duration-[100ms] mb-[20px] px-[15px] text-[16px] text-[#555555]"),children:a.name},"sub-category-key-".concat(b))})]})]})},w=c(26042),x=c(87536),y=c(74634),z=c(65791),A=c(32130),B=c(50975),C=c(71767),D=function(){var a,b=(0,l.useState)(!1),c=b[0],f=b[1],g=(0,l.useState)(!1),j=g[0],m=g[1],p=(0,l.useState)(null),q=p[0],r=p[1],s=(0,x.cI)({}),v=s.control,C=s.clearErrors,D=s.reset,F=s.setError,G=s.unregister,H=(s.trigger,s.setValue),I=s.getValues,J=s.handleSubmit,K=s.formState.errors,L=l.createRef(),M=(a=(0,d.Z)(h().mark(function a(b){var c,d,f;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(b.name=b.name.trim(),b.parent){a.next=8;break}if(b.categories=void 0,b.logo){a.next=6;break}return F("logo",{type:"required"}),a.abrupt("return");case 6:a.next=9;break;case 8:b.logo=void 0;case 9:if(m(!0),a.prev=10,console.log("values: ".concat(b.logo)),(c=new FormData).append("name",b.name),b.parent&&c.append("parent",b.parent._id),b.logo&&c.append("logo",b.logo),b.categories)for(d=0;d<b.categories.length;d++)c.append("categories",b.categories[d]._id);return a.next=19,k().post("/api/v1/brands",c,{headers:(0,e.Z)({},A.G.AddAccessTokenToHeader,!0)});case 19:if(f=a.sent,console.log(f),!0!==f.data.isSuccess){a.next=26;break}return u.eventManager.emit("brands:add:response:".concat(q),!0),O(),m(!1),a.abrupt("return");case 26:throw Error("failed to add new brand");case 29:a.prev=29,a.t0=a.catch(10),console.log("[addBrand] - error -",a.t0),m(!1);case 33:case"end":return a.stop()}},a,null,[[10,29]])})),function(b){return a.apply(this,arguments)}),N=function(a){f(!0),r(a)},O=function(){f(!1),r(null),D(),m(!1)};return(0,l.useEffect)(function(){return u.eventManager.on("brands:add",N),function(){u.eventManager.off("brands:add",N)}},[]),(0,i.jsx)(z.Z,{title:"Add Brand",onClose:O,visible:c,useClassicContainer:!0,tools:(0,i.jsx)(n.z,{type:"submit",size:"small",loading:j,children:"Add"}),modalBox:function(a){return(0,i.jsx)("form",{onSubmit:J(M),children:a})},children:(0,i.jsxs)("div",{className:"flex flex-col space-y-[20px]",children:[(0,i.jsx)(x.Qr,{control:v,name:"name",rules:{required:!0},render:function(a){var b=a.field;return(0,i.jsxs)(y.sp,{label:"Name:",children:[(0,i.jsx)(y.II,(0,w.Z)({className:"w-full",iserror:void 0!=K.name},b)),(0,i.jsx)(y.pd,{error:"Required",show:void 0!=K.name})]})}}),(0,i.jsx)(x.Qr,{control:v,name:"parent",render:function(a){var b,c=a.field;return(0,i.jsxs)("div",{className:"space-y-[20px]",children:[(0,i.jsx)(y.sp,{label:"Subbrand of:",children:(0,i.jsxs)("div",{className:"flex items-center relative",children:[(0,i.jsx)(y.JD,{value:null===(b=c.value)|| void 0===b?void 0:b.name,notSelectedValue:"Not Selected",onClick:function(){var a=(0,o.Z)();u.eventManager.emit("brands:select",a,c.value?[c.value._id]:[]),u.eventManager.once("brands:select:response:".concat(a),function(a){H("parent",a),G("logo")})},render:function(a){var b;return(0,i.jsxs)("div",{className:"flex items-center space-x-[10px]",children:[(0,i.jsx)("img",{src:"/cdn/".concat(null===(b=c.value)|| void 0===b?void 0:b.logo),className:"rounded-main/2 border bg-white border-[#E5E5E5] w-[20px] h-[20px]"}),(0,i.jsx)("span",{className:"font-[500] text-[15.5px]",children:a})]})}}),c.value&&(0,i.jsx)("button",{type:"button",className:"absolute right-[10px]",onClick:function(){H("parent",void 0),G("categories")},children:(0,i.jsx)(t.Z,{name:"close",size:12})})]})}),c.value&&(0,i.jsx)(E,{getValues:I,errors:K,control:v}),!c.value&&(0,i.jsx)(x.Qr,{control:v,name:"logo",rules:{required:!0},render:function(a){var b=a.field;return(0,i.jsxs)(y.sp,{error:void 0!=K.logo,label:"Icon:",children:[(0,i.jsx)(B.j,{ref:L,onClick:function(){var a;null===(a=L.current)|| void 0===a||a.click()},image:b.value&&URL.createObjectURL(b.value),onChange:function(a){if(a.target.value){var b=a.target.files[0];b&&(H("logo",b),C("logo"))}},height:"75px",width:"75px"}),(0,i.jsx)(y.pd,{error:"Required",show:void 0!=K.logo})]})}})]})}})]})})},E=function(a){var b=a.control,c=(a.getValues,a.errors),d=(0,x.Dq)({control:b,name:"categories",rules:{required:!0,minLength:1}}),e=d.append,f=d.fields,g=d.remove;return(0,i.jsxs)(y.sp,{label:"Categories:",children:[(0,i.jsxs)("div",{className:"flex flex-col space-y-[10px]",children:[f.map(function(a,b){return(0,i.jsxs)("div",{className:"border border-[#E5E5E5] group flex items-center justify-between bg-[#F7F8FA] rounded-main/2 py-[5px] px-[10px]",children:[(0,i.jsx)("span",{className:"font-[500] text-[15px]",children:a.name}),(0,i.jsx)("button",{type:"button",onClick:function(){g(b)},className:"group-hover:visible invisible",children:(0,i.jsx)(t.Z,{name:"close",size:12})})]},a.id)}),(0,i.jsx)(C.z,{show:0===f.length,children:"No category in this brand"}),(0,i.jsx)("div",{}),(0,i.jsxs)("button",{type:"button",onClick:function(){var a=(0,o.Z)();u.eventManager.emit("categories:select:child",a,f.map(function(a){return a._id})),u.eventManager.once("categories:select:child:response:".concat(a),function(a,b){e(a)})},className:"py-[10px] flex items-center space-x-[15px] px-[25px] rounded-main/2 border border-[#E5E5E5] bg-[#F7F8FA]",children:[(0,i.jsx)(t.Z,{name:"plus",color:"#AAAAAA"}),(0,i.jsx)("span",{className:"text-[#AAAAAA] font-[500] text-[13px]",children:"Add Category"})]})]}),(0,i.jsx)(y.pd,{error:"Required",show:void 0!=c.categories})]})},F=c(78119),G=function(){var a,b,c=(0,l.useState)(!1),g=c[0],j=c[1],m=(0,l.useState)(!1),n=m[0],o=m[1],p=(0,l.useState)([]),q=p[0],r=p[1],v=(0,l.useState)(null),w=v[0],x=v[1],y=(0,l.useState)(!1),B=y[0],D=y[1],E=(0,l.useState)(0),G=E[0],H=E[1],I=(0,l.useState)([]),J=I[0],K=I[1],L=(a=(0,d.Z)(h().mark(function a(b){var c,d;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o(!0),a.prev=1,c=!0===b?0:G,a.next=5,k().get("/api/v1/brands",{headers:(0,e.Z)({},A.G.AddAccessTokenToHeader,!0),params:{limit:10,page:c}});case 5:if(!0!==(d=a.sent).data.isSuccess){a.next=12;break}return H(c+1),r(!0===b?d.data.result:(0,f.Z)(q).concat((0,f.Z)(d.data.result))),D(d.data.result.length<10),o(!1),a.abrupt("return");case 12:throw Error("failed to load brands");case 15:a.prev=15,a.t0=a.catch(1),console.log("[loadBrands] - error -",a.t0),o(!1);case 19:case"end":return a.stop()}},a,null,[[1,15]])})),function(b){return a.apply(this,arguments)}),M=function(a){var b={_id:a._id,logo:a.logo,name:a.name};u.eventManager.emit("brands:select:response:".concat(w),b),O()},N=(b=(0,d.Z)(h().mark(function a(b){var c,d=arguments;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=d.length>1&& void 0!==d[1]?d[1]:[],x(b),K(c),j(!0),a.next=6,L(!0);case 6:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)}),O=function(){j(!1),x(null),r([]),H(0),D(!0),K([]),o(!1)};return(0,l.useEffect)(function(){return u.eventManager.on("brands:select",N),function(){u.eventManager.off("brands:select",N)}},[]),(0,i.jsxs)(z.Z,{title:"Select Brand",useClassicContainer:!0,onClose:O,contentLoading:0===q.length&&n,visible:g,children:[(0,i.jsx)("div",{className:"flex flex-col divide-y-2",children:q.map(function(a,b){var c=void 0!==J.find(function(b){return b===a._id});return(0,i.jsxs)("button",{disabled:c,onClick:function(){M(a)},className:s()(c&&"bg-gray-50/50 text-black/50",!c&&"hover:bg-gray-50","flex items-center transition-all duration-[300ms] py-[15px] justify-between"),children:[(0,i.jsxs)("div",{className:"flex items-center space-x-[15px]",children:[(0,i.jsx)("img",{src:"/cdn/".concat(a.logo),className:"w-[20px] h-[20px]"}),(0,i.jsx)("h3",{className:"font-[600] text-[16px]",children:a.name})]}),!c&&(0,i.jsx)(t.Z,{name:"chevronDown",className:"rotate-[-90deg]"})]},"brand-index-".concat(b))})}),(0,i.jsx)(F.n,{show:!B&&0!==q.length,loading:n,onClick:L}),(0,i.jsx)(C.z,{show:0===q.length&&!n,children:"Not found brand"})]})},H=c(39748),I=function(){var a,b,c,f=(0,l.useState)(!1),g=f[0],j=f[1],m=(0,l.useState)(!1),p=m[0],q=m[1],r=(0,l.useState)(null),s=r[0],v=r[1],C=(0,l.useState)(null),D=C[0],E=C[1],F=(0,l.useState)(null),G=F[0],H=F[1],I=(0,x.cI)({}),K=I.control,L=I.clearErrors,M=I.reset,N=I.setError,O=I.unregister,P=(I.trigger,I.setValue),Q=I.getValues,R=I.handleSubmit,S=I.formState.errors,T=l.createRef(),U=(a=(0,d.Z)(h().mark(function a(b){var c,d;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return q(!0),a.prev=1,a.next=4,k().get("/api/v1/brands/".concat(b),{headers:(0,e.Z)({},A.G.AddAccessTokenToHeader,!0)});case 4:if(!0!==(c=a.sent).data.isSuccess){a.next=14;break}return d=c.data.result,E(b),H(d),P("name",d.name),P("categories",d.categories),P("parent",d.parent),q(!1),a.abrupt("return");case 14:throw Error("failed to load original brand");case 17:a.prev=17,a.t0=a.catch(1),console.log("[loadOriginal] - error -",a.t0),q(!1);case 21:case"end":return a.stop()}},a,null,[[1,17]])})),function(b){return a.apply(this,arguments)}),V=(b=(0,d.Z)(h().mark(function a(b){var c,d,f,g,i,j;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(console.log(D),D){a.next=4;break}return a.abrupt("return");case 4:if(console.log(b),b.name=b.name.trim(),f=!1,!((null===(c=b.parent)|| void 0===c?void 0:c._id)!==(null==G?void 0:null===(d=G.parent)|| void 0===d?void 0:d._id)&&null===b.parent)||b.logo){a.next=11;break}return N("logo",{type:"required"}),a.abrupt("return");case 11:if((null==G?void 0:G.parent)===null&&b.logo&&(f=!0),q(!0),a.prev=13,console.log(b),(g=new FormData).append("name",b.name),g.append("is_image_changed","".concat(f)),b.parent&&g.append("parent",b.parent._id),b.logo&&g.append("logo",b.logo),b.categories)for(i=0;i<b.categories.length;i++)g.append("categories",b.categories[i]._id);return a.next=23,k().put("/api/v1/brands/".concat(D),g,{headers:(0,e.Z)({},A.G.AddAccessTokenToHeader,!0)});case 23:if(j=a.sent,console.log(j),!0!==j.data.isSuccess){a.next=30;break}return u.eventManager.emit("brands:edit:response:".concat(s),!0),X(),q(!1),a.abrupt("return");case 30:throw Error("failed to edit new brand");case 33:a.prev=33,a.t0=a.catch(13),console.log("[editBrand] - error -",a.t0),q(!1);case 37:case"end":return a.stop()}},a,null,[[13,33]])})),function(a){return b.apply(this,arguments)}),W=(c=(0,d.Z)(h().mark(function a(b,c){return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return v(c),j(!0),q(!0),a.next=5,U(b);case 5:case"end":return a.stop()}},a)})),function(a,b){return c.apply(this,arguments)}),X=function(){j(!1),v(null),H(null),E(null),M(),q(!1)};return(0,l.useEffect)(function(){return u.eventManager.on("brands:edit",W),function(){u.eventManager.off("brands:edit",W)}},[]),(0,i.jsx)(z.Z,{title:"Edit Brand",onClose:X,visible:g,useClassicContainer:!0,tools:(0,i.jsx)(n.z,{type:"submit",size:"small",loading:p,children:"Edit"}),modalBox:function(a){return(0,i.jsx)("form",{onSubmit:R(V),children:a})},contentLoading:p&&null===G,children:(0,i.jsxs)("div",{className:"flex flex-col space-y-[20px]",children:[(0,i.jsx)(x.Qr,{control:K,name:"name",rules:{required:!0},render:function(a){var b=a.field;return(0,i.jsxs)(y.sp,{label:"Name:",children:[(0,i.jsx)(y.II,(0,w.Z)({className:"w-full",iserror:void 0!=S.name},b)),(0,i.jsx)(y.pd,{error:"Required",show:void 0!=S.name})]})}}),(0,i.jsx)(x.Qr,{control:K,name:"parent",render:function(a){var b,c=a.field;return(0,i.jsxs)("div",{className:"space-y-[20px]",children:[(0,i.jsx)(y.sp,{label:"Subbrand of:",children:(0,i.jsxs)("div",{className:"flex items-center relative",children:[(0,i.jsx)(y.JD,{disabled:(null==G?void 0:G.parent)===null,value:null===(b=c.value)|| void 0===b?void 0:b.name,notSelectedValue:"Not Selected",onClick:function(){var a=(0,o.Z)();u.eventManager.emit("brands:select",a,c.value?[c.value._id]:[]),u.eventManager.once("brands:select:response:".concat(a),function(a){P("parent",a),O("logo")})},render:function(a){var b;return(0,i.jsxs)("div",{className:"flex items-center space-x-[10px]",children:[(0,i.jsx)("img",{src:"/cdn/".concat(null===(b=c.value)|| void 0===b?void 0:b.logo),className:"rounded-main/2 border bg-white border-[#E5E5E5] w-[20px] h-[20px]"}),(0,i.jsx)("span",{className:"font-[500] text-[15.5px]",children:a})]})}}),c.value&&(0,i.jsx)("button",{type:"button",className:"absolute right-[10px]",onClick:function(){P("parent",G.parent)},children:(0,i.jsx)(t.Z,{name:"close",size:12})})]})}),c.value&&(0,i.jsx)(J,{getValues:Q,errors:S,control:K}),!c.value&&(0,i.jsx)(x.Qr,{control:K,name:"logo",render:function(a){var b=a.field;return(0,i.jsxs)(y.sp,{error:void 0!=S.logo,label:"Icon:",children:[(0,i.jsx)(B.j,{ref:T,onClick:function(){var a;null===(a=T.current)|| void 0===a||a.click()},image:b.value?URL.createObjectURL(b.value):"/cdn/".concat(null==G?void 0:G.logo),onChange:function(a){if(a.target.value){var b=a.target.files[0];b&&(P("logo",b),L("logo"))}},height:"75px",width:"75px"}),(0,i.jsx)(y.pd,{error:"Required",show:void 0!=S.logo})]})}})]})}})]})})},J=function(a){var b=a.control,c=(a.getValues,a.errors),d=(0,x.Dq)({control:b,name:"categories"}),e=d.append,f=d.fields,g=d.remove;return(0,i.jsxs)(y.sp,{label:"Categories:",children:[(0,i.jsxs)("div",{className:"flex flex-col space-y-[10px]",children:[f.map(function(a,b){return(0,i.jsxs)("div",{className:"border border-[#E5E5E5] group flex items-center justify-between bg-[#F7F8FA] rounded-main/2 py-[5px] px-[10px]",children:[(0,i.jsx)("span",{className:"font-[500] text-[15px]",children:a.name}),(0,i.jsx)("button",{type:"button",onClick:function(){g(b)},className:"group-hover:visible invisible",children:(0,i.jsx)(t.Z,{name:"close",size:12})})]},a.id)}),(0,i.jsx)(C.z,{show:0===f.length,children:"No category in this brand"}),(0,i.jsx)("div",{}),(0,i.jsxs)("button",{type:"button",onClick:function(){var a=(0,o.Z)();u.eventManager.emit("categories:select:child",a,f.map(function(a){return a._id})),u.eventManager.once("categories:select:child:response:".concat(a),function(a,b){e(a)})},className:"py-[10px] flex items-center space-x-[15px] px-[25px] rounded-main/2 border border-[#E5E5E5] bg-[#F7F8FA]",children:[(0,i.jsx)(t.Z,{name:"plus",color:"#AAAAAA"}),(0,i.jsx)("span",{className:"text-[#AAAAAA] font-[500] text-[13px]",children:"Add Category"})]})]}),(0,i.jsx)(y.pd,{error:"Required",show:void 0!=c.categories})]})},K=c(67971),L=function(){var a,b=(0,l.useState)(!1),c=b[0],g=b[1],j=(0,l.useState)(!1),r=j[0],s=j[1],t=(0,l.useState)(0),w=t[0],x=t[1],y=(0,l.useState)([]),z=y[0],B=y[1],C=(a=(0,d.Z)(h().mark(function a(b){var c;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return!0==b&&(x(0),s(!1)),g(!0),a.prev=2,a.next=5,k().get("/api/v1/brands",{headers:(0,e.Z)({},A.G.AddAccessTokenToHeader,!0),params:{page:!0==b?0:w,limit:10}});case 5:if(!0!=(c=a.sent).data.isSuccess){a.next=12;break}return B(!0===b?c.data.result:(0,f.Z)(z).concat((0,f.Z)(c.data.result))),s(c.data.result.length<10),x(w+1),g(!1),a.abrupt("return");case 12:throw Error("failed to load brands");case 15:a.prev=15,a.t0=a.catch(2),console.log("[loadBrands] - error -",a.t0);case 18:g(!1);case 19:case"end":return a.stop()}},a,null,[[2,15]])})),function(b){return a.apply(this,arguments)});return(0,l.useEffect)(function(){c||C()},[]),(0,i.jsxs)(p.Z,{className:"relative",children:[(0,i.jsx)(q.V2,{children:(0,i.jsx)(q.dR,{children:(0,i.jsx)(q.ZX,{icon:"plus",onClick:function(){var a,b=(0,o.Z)();u.eventManager.emit("brands:add",b),u.eventManager.once("brands:add:response:".concat(b),(a=(0,d.Z)(h().mark(function a(b){return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b){a.next=4;break}return console.log("successfuly added new brand"),a.next=4,C(!0);case 4:case"end":return a.stop()}},a)})),function(b){return a.apply(this,arguments)}))},children:"New Brand"})})}),c&&(0,i.jsx)("div",{className:"flex absolute w-full h-full z-[10] flex-grow bg-[rgba(255,255,255,0.4)] items-center justify-center py-10",children:(0,i.jsx)(m.Z,{color:K.Colors.primary,loading:c})}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4 px-7",children:z.map(function(a,b){return(0,i.jsx)(v,{brand:a,reload:(0,d.Z)(h().mark(function a(){return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,C(!0);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a)}))},"brand-index-".concat(b))})}),!c&&!r&&(0,i.jsx)("div",{className:"flex items-center justify-center py-10",children:(0,i.jsx)(n.z,{disabled:c,size:"small",onClick:C,children:"load more"})}),(0,i.jsx)(D,{}),(0,i.jsx)(I,{}),(0,i.jsx)(G,{}),(0,i.jsx)(H.d,{})]})}}},function(a){a.O(0,[536,917,774,888,179],function(){var b;return a(a.s=67322)}),_N_E=a.O()}])